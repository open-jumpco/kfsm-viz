== PayingTurnstileFSM State Chart

=== State Map coins

|===
| Start | Event[Guard] | Target | Action

| COINS
| \<<automatic>> `[{coins > requiredCoins}]`
| UNLOCKED
|  `{returnCoin(coins-requiredCoins);unlock();reset();}`

| COINS
| \<<automatic>> `[{coins == requiredCoins}]`
| UNLOCKED
|  `{unlock();reset();}`

| COINS
| COIN
| COINS
|  `{coin(it);if(coins < requiredCoins){println("Please add ${requiredCoins-coins}");};}`
|===

=== Default State Map

|===
| Start | Event[Guard] | Target | Action

| LOCKED
| COIN
| COINS
|  `{coin(it);unlock();reset();}`

| LOCKED
| COIN `[{requiredCoins >= coins+(it?:error("argument required"))}]`
| COINS
|  `{coin(it);println("Coins=$coins, Please add ${requiredCoins-coins}");}`

| UNLOCKED
| COIN
| UNLOCKED
|  `{returnCoin(coin(it));}`

| UNLOCKED
| PASS
| LOCKED
|  `{lock();}`
|===

