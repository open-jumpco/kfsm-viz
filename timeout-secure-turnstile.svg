<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="445px" preserveAspectRatio="none" style="width:1570px;height:445px;background:#FFFFFF;" version="1.1" viewBox="0 0 1570 445" width="1570px" zoomAndPan="magnify"><defs><filter height="300%" id="f1r1d220d33red" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#F8F8F8" filter="url(#f1r1d220d33red)" height="426.4248" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="1551.9978" x="7" y="7"/><rect fill="#FFFFFF" height="392.8154" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="1545.9978" x="10" y="37.6094"/><line style="stroke:#383838;stroke-width:1.5;" x1="7" x2="1558.9978" y1="34.6094" y2="34.6094"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="182" x="691.9989" y="26.5332">TimerSecureTurnstileFSM</text><ellipse cx="552.9967" cy="55.6094" fill="#000000" filter="url(#f1r1d220d33red)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><g id="TimerSecureTurnstileFSM.UNLOCKED"><rect fill="#F8F8F8" filter="url(#f1r1d220d33red)" height="50" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="98" x="503.9968" y="102.6094"/><line style="stroke:#383838;stroke-width:1.5;" x1="503.9968" x2="601.9968" y1="130.2188" y2="130.2188"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="513.9968" y="122.1426">UNLOCKED</text></g><g id="TimerSecureTurnstileFSM.LOCKED"><rect fill="#F8F8F8" filter="url(#f1r1d220d33red)" height="50" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="78" x="513.9968" y="331.6094"/><line style="stroke:#383838;stroke-width:1.5;" x1="513.9968" x2="591.9968" y1="359.2188" y2="359.2188"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58" x="523.9968" y="351.1426">LOCKED</text></g><!--MD5=[e94777a82bbc93a409d8dea03011b069]
link *start*TimerSecureTurnstileFSM to UNLOCKED--><path d="M552.9967,65.7604 C552.9967,73.7954 552.9967,85.9354 552.9967,97.2634 " fill="none" id="*start*TimerSecureTurnstileFSM-to-UNLOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="552.9967,102.3934,556.9967,93.3934,552.9967,97.3934,548.9967,93.3934,552.9967,102.3934" style="stroke:#383838;stroke-width:1.0;"/><!--MD5=[5d767a4319f708ea6a1e1270c7244025]
link LOCKED to LOCKED--><path d="M592.1587,348.3208 C602.3287,348.8303 609.9967,351.5931 609.9967,356.6094 C609.9967,360.7635 604.7378,363.3722 597.1547,364.4356 " fill="none" id="LOCKED-to-LOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="592.1587,364.898,601.4895,368.0504,597.1374,364.4366,600.7512,360.0845,592.1587,364.898" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="615.9967" y="319.1792">CARD [cardId-&gt;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="631.9967" y="336.1528">requireNotNull(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="312" x="631.9967" y="353.1265">isOverrideCard(cardId)&amp;&amp;overrideActive;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="615.9967" y="370.1001">] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="631.9967" y="387.0737">cancelOverride()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="615.9967" y="404.0474">}</text><!--MD5=[5d767a4319f708ea6a1e1270c7244025]
link LOCKED to LOCKED--><path d="M592.2707,347.1592 C693.6778,334.9209 949.9967,338.071 949.9967,356.6094 C949.9967,374.84 702.1178,378.1891 597.4468,366.6564 " fill="none" id="LOCKED-to-LOCKED-1" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="592.2707,366.0596,600.7532,371.0644,597.2378,366.6324,601.6698,363.1171,592.2707,366.0596" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="955.9967" y="319.1792">CARD [cardId-&gt;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="971.9967" y="336.1528">requireNotNull(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="971.9967" y="353.1265">isOverrideCard(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="955.9967" y="370.1001">] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="971.9967" y="387.0737">activateOverride()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="955.9967" y="404.0474">}</text><!--MD5=[c03bbcbe1ea2187b5aae6c6faf6bf9ae]
link LOCKED to UNLOCKED--><path d="M592.3527,351.0115 C637.0798,343.4482 708.1278,323.8056 740.9967,273.6094 C766.0748,235.3114 769.6207,206.3344 740.9967,170.6094 C724.4688,149.9814 656.6737,138.8144 607.2248,133.2894 " fill="none" id="LOCKED-to-UNLOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="602.1977,132.7404,610.7088,137.6964,607.168,133.2847,611.5797,129.7439,602.1977,132.7404" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="761.9967" y="184.6792">CARD [cardId-&gt;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="777.9967" y="201.6528">requireNotNull(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="288" x="777.9967" y="218.6265">overrideActive||isValidCard(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="761.9967" y="235.6001">] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="777.9967" y="252.5737">unlock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="761.9967" y="269.5474">}</text><!--MD5=[5d767a4319f708ea6a1e1270c7244025]
link LOCKED to LOCKED--><path d="M592.1178,344.9625 C728.3108,323.709 1161.9978,327.5913 1161.9978,356.6094 C1161.9978,385.2591 739.2528,389.4071 597.4477,369.0536 " fill="none" id="LOCKED-to-LOCKED-2" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="592.1178,368.2563,600.4266,373.5442,597.0627,368.9963,601.6106,365.6323,592.1178,368.2563" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="1167.9978" y="310.6792">CARD [cardId-&gt;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="360" x="1183.9978" y="327.6528">requireNotNull(cardId){"cardId is required"};</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="1183.9978" y="344.6265">!isValidCard(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="1167.9978" y="361.6001">] -&gt; {cardId-&gt;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="1183.9978" y="378.5737">requireNotNull(cardId)</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="1183.9978" y="395.5474">invalidCard(cardId)</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="1167.9978" y="412.521">}</text><!--MD5=[33c2fb760a7074ec24359010ff9693f6]
link UNLOCKED to LOCKED--><path d="M503.7028,129.0144 C382.8418,130.5174 79.3917,137.5764 48.9966,170.6094 C18,204.2964 19.3395,238.7374 48.9966,273.6094 C108.0047,342.9939 397.0138,353.8234 508.7668,355.3958 " fill="none" id="UNLOCKED-to-LOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="513.9528,355.4638,505.0061,351.3458,508.9532,355.3981,504.901,359.3451,513.9528,355.4638" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="368" x="49.9966" y="201.6792">«timeout = TimerSecureTurnstile::timeout» -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216" x="65.9966" y="218.6528">println("Timeout. Locking")</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="65.9966" y="235.6265">lock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="49.9966" y="252.6001">}</text><!--MD5=[33c2fb760a7074ec24359010ff9693f6]
link UNLOCKED to LOCKED--><path d="M503.9128,134.4194 C481.1078,139.8544 455.9908,150.3514 441.9968,170.6094 C415.9778,208.2734 421.3758,232.7394 441.9968,273.6094 C456.0678,301.4994 484.5998,322.2508 509.2118,335.9005 " fill="none" id="UNLOCKED-to-LOCKED-1" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="513.7568,338.3666,507.7534,330.5589,509.3619,335.9823,503.9385,337.5907,513.7568,338.3666" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="442.9968" y="184.6792">CARD [cardId-&gt;</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="458.9968" y="201.6528">requireNotNull(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184" x="458.9968" y="218.6265">isOverrideCard(cardId);</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="442.9968" y="235.6001">] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="458.9968" y="252.5737">lock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="442.9968" y="269.5474">}</text><!--MD5=[33c2fb760a7074ec24359010ff9693f6]
link UNLOCKED to LOCKED--><path d="M602.2628,139.8754 C618.3628,146.1464 634.5247,155.8064 643.9967,170.6094 C668.6687,209.1694 662.6078,231.7854 643.9967,273.6094 C634.0288,296.0084 614.5858,314.8624 596.2208,328.8219 " fill="none" id="UNLOCKED-to-LOCKED-2" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="592.0777,331.9046,601.6863,329.7421,596.0894,328.9202,596.9113,323.3234,592.0777,331.9046" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72" x="660.9967" y="210.1792">PASS -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="676.9967" y="227.1528">lock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="660.9967" y="244.1265">}</text><!--MD5=[87d43bfad711cee767419e7913032102]
@startuml
skinparam monochrome true
skinparam StateFontName Helvetica
skinparam defaultFontName Monospaced
skinparam defaultFontStyle Bold
skinparam state {
    FontStyle Bold
}
state TimerSecureTurnstileFSM {
[*] - -> UNLOCKED
LOCKED - -> LOCKED : CARD [cardId->\l  requireNotNull(cardId);\l  isOverrideCard(cardId)&&overrideActive;\l] -> {\l  cancelOverride()\l}
LOCKED - -> LOCKED : CARD [cardId->\l  requireNotNull(cardId);\l  isOverrideCard(cardId);\l] -> {\l  activateOverride()\l}
LOCKED - -> UNLOCKED : CARD [cardId->\l  requireNotNull(cardId);\l  overrideActive||isValidCard(cardId);\l] -> {\l  unlock()\l}
LOCKED - -> LOCKED : CARD [cardId->\l  requireNotNull(cardId){"cardId is required"};\l  !isValidCard(cardId);\l] -> {cardId->\l  requireNotNull(cardId)\l  invalidCard(cardId)\l}
UNLOCKED - -> LOCKED : <<timeout = TimerSecureTurnstile::timeout>> -> {\l  println("Timeout. Locking")\l  lock()\l}
UNLOCKED - -> LOCKED : CARD [cardId->\l  requireNotNull(cardId);\l  isOverrideCard(cardId);\l] -> {\l  lock()\l}
UNLOCKED - -> LOCKED : PASS -> {\l  lock()\l}
}
@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CAT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: ZA
--></g></svg>