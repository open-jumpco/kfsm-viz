<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="798px" preserveAspectRatio="none" style="width:867px;height:798px;background:#FFFFFF;" version="1.1" viewBox="0 0 867 798" width="867px" zoomAndPan="magnify"><defs><filter height="300%" id="ft2rg0mm5n2p8" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[eda83f66e697e6a82d4f59efbe14dd2f]
cluster coins--><rect fill="#F8F8F8" filter="url(#ft2rg0mm5n2p8)" height="373" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="759" x="7" y="413"/><rect fill="#FFFFFF" height="339.3906" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="753" x="10" y="443.6094"/><line style="stroke:#383838;stroke-width:1.5;" x1="7" x2="766" y1="440.6094" y2="440.6094"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="38" x="367.5" y="431.5332">coins</text><!--MD5=[72d821c25f0eb57cd4e4aca2990b7e46]
cluster PayingTurnstileFSM--><rect fill="#F8F8F8" filter="url(#ft2rg0mm5n2p8)" height="199" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="155" x="126" y="88"/><rect fill="#FFFFFF" height="165.3906" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="149" x="129" y="118.6094"/><line style="stroke:#383838;stroke-width:1.5;" x1="126" x2="281" y1="115.6094" y2="115.6094"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="139" x="134" y="106.5332">PayingTurnstileFSM</text><g id="coins.COINS"><rect fill="#F8F8F8" filter="url(#ft2rg0mm5n2p8)" height="50" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="64" x="119" y="480.5"/><line style="stroke:#383838;stroke-width:1.5;" x1="119" x2="183" y1="508.1094" y2="508.1094"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="44" x="129" y="500.0332">COINS</text></g><g id="coins.UNLOCKED"><rect fill="#F8F8F8" filter="url(#ft2rg0mm5n2p8)" height="50" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="98" x="371" y="714"/><line style="stroke:#383838;stroke-width:1.5;" x1="371" x2="469" y1="741.6094" y2="741.6094"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="381" y="733.5332">UNLOCKED</text></g><ellipse cx="212" cy="142" fill="#000000" filter="url(#ft2rg0mm5n2p8)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><g id="PayingTurnstileFSM.LOCKED"><rect fill="#F8F8F8" filter="url(#ft2rg0mm5n2p8)" height="50" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="78" x="173" y="213"/><line style="stroke:#383838;stroke-width:1.5;" x1="173" x2="251" y1="240.6094" y2="240.6094"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58" x="183" y="232.5332">LOCKED</text></g><path d="M32.5,6 L32.5,32.9736 L245.5,32.9736 L245.5,16 L235.5,6 L32.5,6 " fill="#EBEBEB" filter="url(#ft2rg0mm5n2p8)" style="stroke:#383838;stroke-width:1.0;"/><path d="M235.5,6 L235.5,16 L245.5,16 L235.5,6 " fill="#EBEBEB" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192" x="38.5" y="24.0698">«invariant» {coins &gt;= 0}</text><!--MD5=[489a7892458dbac9f7d2d3f1d120390f]
link COINS to UNLOCKED--><path d="M118.559,525.061 C96.088,539.939 67.9689,563.083 55,592 C39.3589,626.875 30.2617,648.863 55,678 C94.212,724.1838 273.902,734.8826 365.692,737.3159 " fill="none" id="COINS-to-UNLOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="370.802,737.4452,361.9066,733.2176,365.8036,737.3181,361.7032,741.2151,370.802,737.4452" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="320" x="56" y="606.0698">«automatic» [coins &gt; requiredCoins] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248" x="72" y="623.0435">returnCoin(coins-requiredCoins)</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="72" y="640.0171">unlock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="56" x="72" y="656.9907">reset()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="56" y="673.9644">}</text><!--MD5=[489a7892458dbac9f7d2d3f1d120390f]
link COINS to UNLOCKED--><path d="M183.238,509.272 C233.038,515.312 328.408,534.165 381,592 C410.404,624.336 418.055,676.412 419.812,708.8442 " fill="none" id="COINS-to-UNLOCKED-1" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="420.045,713.8747,423.6228,704.6987,419.8128,708.8801,415.6314,705.0701,420.045,713.8747" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="328" x="418" y="614.5698">«automatic» [coins == requiredCoins] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="434" y="631.5435">unlock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="56" x="434" y="648.5171">reset()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="418" y="665.4907">}</text><!--MD5=[e95c1cf331ed2c204aaf3b73fde9f70f]
link COINS to COINS--><path d="M183.055,482.732 C201.2,478.286 218,485.875 218,505.5 C218,523.285 204.203,531.186 188.11,529.201 " fill="none" id="COINS-to-COINS" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="183.055,528.268,191.1784,533.8367,187.9718,529.1765,192.632,525.9699,183.055,528.268" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72" x="224" y="468.0698">COIN -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="240" y="485.0435">coin(it)</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="208" x="240" y="502.0171">if(coins &lt; requiredCoins){</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="352" x="240" y="518.9907">println("Please add ${requiredCoins-coins}")</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="240" y="535.9644">}</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="224" y="552.938">}</text><!--MD5=[6f5c84d3c685c98c737e0d9e161f05e4]
link *start*PayingTurnstileFSM to LOCKED--><path d="M212,152.013 C212,164.698 212,188.409 212,207.57 " fill="none" id="*start*PayingTurnstileFSM-to-LOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="212,212.84,216,203.84,212,207.84,208,203.84,212,212.84" style="stroke:#383838;stroke-width:1.0;"/><!--MD5=[26bbedbc5621f2374cb324e59b4d4bff]
link LOCKED to COINS--><path d="M172.732,249.922 C143.382,260.377 105.298,279.344 87,311 C55.6494,365.237 98.274,437.006 127.548,476.115 " fill="none" id="LOCKED-to-COINS" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="130.69,480.258,128.4352,470.6707,127.6672,476.2752,122.0627,475.5072,130.69,480.258" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72" x="88" y="325.0698">COIN -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="104" y="342.0435">coin(it)</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="104" y="359.0171">unlock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="56" x="104" y="375.9907">reset()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="88" y="392.9644">}</text><!--MD5=[26bbedbc5621f2374cb324e59b4d4bff]
link LOCKED to COINS--><path d="M206.479,263.03 C195.257,311.875 169.82,422.587 157.684,475.407 " fill="none" id="LOCKED-to-COINS-1" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="156.552,480.333,162.4664,472.4577,157.672,475.4601,154.6697,470.6657,156.552,480.333" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="536" x="195" y="333.5698">COIN [requiredCoins &gt;= coins+(it?:error("argument required"))] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="211" y="350.5435">coin(it)</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="464" x="211" y="367.5171">println("Coins=$coins, Please add ${requiredCoins-coins}")</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="195" y="384.4907">}</text><!--MD5=[d9263dcde7f2990f059c51f0359981af]
link UNLOCKED to UNLOCKED--><path d="M469.18,719.5762 C488.195,718.7129 504,725.1875 504,739 C504,751.5176 491.02,758.0086 474.433,758.4731 " fill="none" id="UNLOCKED-to-UNLOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="469.18,758.4238,478.1419,762.5085,474.1798,758.4709,478.2173,754.5088,469.18,758.4238" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72" x="510" y="727.0698">COIN -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="160" x="526" y="744.0435">returnCoin(coin(it))</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="510" y="761.0171">}</text><!--MD5=[33c2fb760a7074ec24359010ff9693f6]
link UNLOCKED to LOCKED--><path d="M469.211,736.5124 C552.502,732.8445 715.673,720.3065 751,678 C803.297,615.371 794.848,371.407 740,311 C707.599,275.314 378.041,250.015 256.611,241.841 " fill="none" id="UNLOCKED-to-LOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="251.335,241.487,260.0475,246.0796,256.3238,241.8212,260.5822,238.0975,251.335,241.487" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72" x="787" y="493.5698">PASS -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="803" y="510.5435">lock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="787" y="527.5171">}</text><!--MD5=[ba0c8b56418edaf07519fb91e23db13d]
link GMN6007 to PayingTurnstileFSM--><path d="M139,33.396 C139,41.046 139,51.4475 139,62.7829 C139,68.4507 139,74.3519 139,80.2594 C139,81.7362 139,83.2135 139,84.6876 C139,85.4247 139,86.1609 139,86.896 C139,87.2635 139,87.6307 139,87.9975 " fill="none" id="GMN6007-PayingTurnstileFSM" style="stroke:#383838;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><!--MD5=[607b881d01623b62ed78b9c023b52746]
@startuml
skinparam monochrome true
skinparam StateFontName Helvetica
skinparam defaultFontName Monospaced
skinparam defaultFontStyle Bold
skinparam state {
    FontStyle Bold
}
state coins {
COINS - -> UNLOCKED : <<automatic>> [coins > requiredCoins] -> {\l  returnCoin(coins-requiredCoins)\l  unlock()\l  reset()\l}
COINS - -> UNLOCKED : <<automatic>> [coins == requiredCoins] -> {\l  unlock()\l  reset()\l}
COINS - -> COINS : COIN -> {\l  coin(it)\l  if(coins < requiredCoins){\l  println("Please add ${requiredCoins-coins}")\l  }\l}
}
state PayingTurnstileFSM {
[*] - -> LOCKED
LOCKED - -> COINS : COIN -> {\l  coin(it)\l  unlock()\l  reset()\l}
LOCKED - -> COINS : COIN [requiredCoins >= coins+(it?:error("argument required"))] -> {\l  coin(it)\l  println("Coins=$coins, Please add ${requiredCoins-coins}")\l}
UNLOCKED - -> UNLOCKED : COIN -> {\l  returnCoin(coin(it))\l}
UNLOCKED - -> LOCKED : PASS -> {\l  lock()\l}
}
note top of PayingTurnstileFSM
<<invariant>> {coins >= 0}
end note
@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CAT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: ZA
--></g></svg>