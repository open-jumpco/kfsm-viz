<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="717px" preserveAspectRatio="none" style="width:899px;height:717px;background:#FFFFFF;" version="1.1" viewBox="0 0 899 717" width="899px" zoomAndPan="magnify"><defs><filter height="300%" id="f6sysqyejfs2z" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[eda83f66e697e6a82d4f59efbe14dd2f]
cluster coins--><rect fill="#F8F8F8" filter="url(#f6sysqyejfs2z)" height="373" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="791" x="7" y="332"/><rect fill="#FFFFFF" height="339.3906" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="785" x="10" y="362.6094"/><line style="stroke:#383838;stroke-width:1.5;" x1="7" x2="798" y1="359.6094" y2="359.6094"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="38" x="383.5" y="350.5332">coins</text><!--MD5=[72d821c25f0eb57cd4e4aca2990b7e46]
cluster PayingTurnstileFSM--><rect fill="#F8F8F8" filter="url(#f6sysqyejfs2z)" height="118" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="155" x="139" y="88"/><rect fill="#FFFFFF" height="84.3906" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="149" x="142" y="118.6094"/><line style="stroke:#383838;stroke-width:1.5;" x1="139" x2="294" y1="115.6094" y2="115.6094"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="139" x="147" y="106.5332">PayingTurnstileFSM</text><g id="coins.COINS"><rect fill="#F8F8F8" filter="url(#f6sysqyejfs2z)" height="50" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="64" x="135" y="399.5"/><line style="stroke:#383838;stroke-width:1.5;" x1="135" x2="199" y1="427.1094" y2="427.1094"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="44" x="145" y="419.0332">COINS</text></g><g id="coins.UNLOCKED"><rect fill="#F8F8F8" filter="url(#f6sysqyejfs2z)" height="50" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="98" x="387" y="633"/><line style="stroke:#383838;stroke-width:1.5;" x1="387" x2="485" y1="660.6094" y2="660.6094"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="397" y="652.5332">UNLOCKED</text></g><g id="PayingTurnstileFSM.LOCKED"><rect fill="#F8F8F8" filter="url(#f6sysqyejfs2z)" height="50" rx="12.5" ry="12.5" style="stroke:#383838;stroke-width:1.5;" width="78" x="189" y="132"/><line style="stroke:#383838;stroke-width:1.5;" x1="189" x2="267" y1="159.6094" y2="159.6094"/><text fill="#000000" font-family="Helvetica" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58" x="199" y="151.5332">LOCKED</text></g><path d="M45.5,6 L45.5,32.9736 L258.5,32.9736 L258.5,16 L248.5,6 L45.5,6 " fill="#EBEBEB" filter="url(#f6sysqyejfs2z)" style="stroke:#383838;stroke-width:1.0;"/><path d="M248.5,6 L248.5,16 L258.5,16 L248.5,6 " fill="#EBEBEB" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192" x="51.5" y="24.0698">«invariant» {coins &gt;= 0}</text><!--MD5=[489a7892458dbac9f7d2d3f1d120390f]
link COINS to UNLOCKED--><path d="M134.993,439.729 C108.12,453.622 71.5413,477.562 55,511 C38.0522,545.259 30.1638,567.947 55,597 C96.41,645.4411 286.873,655.0176 381.844,656.7434 " fill="none" id="COINS-to-UNLOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="386.849,656.8287,377.9177,652.6776,381.8497,656.7444,377.7829,660.6764,386.849,656.8287" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="336" x="56" y="525.0698">«automatic» [{coins &gt; requiredCoins}] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248" x="72" y="542.0435">returnCoin(coins-requiredCoins)</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="72" y="559.0171">unlock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="56" x="72" y="575.9907">reset()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="56" y="592.9644">}</text><!--MD5=[489a7892458dbac9f7d2d3f1d120390f]
link COINS to UNLOCKED--><path d="M199.238,428.272 C249.038,434.312 344.408,453.165 397,511 C426.404,543.336 434.055,595.412 435.812,627.8442 " fill="none" id="COINS-to-UNLOCKED-1" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="436.045,632.8747,439.6228,623.6987,435.8128,627.8801,431.6314,624.0701,436.045,632.8747" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="344" x="434" y="533.5698">«automatic» [{coins == requiredCoins}] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="450" y="550.5435">unlock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="56" x="450" y="567.5171">reset()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="434" y="584.4907">}</text><!--MD5=[e95c1cf331ed2c204aaf3b73fde9f70f]
link COINS to COINS--><path d="M199.055,401.732 C217.2,397.286 234,404.875 234,424.5 C234,442.285 220.203,450.186 204.11,448.201 " fill="none" id="COINS-to-COINS" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="199.055,447.268,207.1784,452.8367,203.9718,448.1765,208.632,444.9699,199.055,447.268" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72" x="240" y="387.0698">COIN -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="256" y="404.0435">coin(it)</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="208" x="256" y="421.0171">if(coins &lt; requiredCoins){</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="352" x="256" y="437.9907">println("Please add ${requiredCoins-coins}")</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="256" y="454.9644">}</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="240" y="471.938">}</text><!--MD5=[26bbedbc5621f2374cb324e59b4d4bff]
link LOCKED to COINS--><path d="M218.186,182.125 C211.13,196.21 200.171,212.942 185,222 C169.28,231.385 115.302,216.44 103,230 C60.1333,277.252 109.4,353.933 142.281,395.147 " fill="none" id="LOCKED-to-COINS" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="145.606,399.265,143.0652,389.7495,142.4653,395.3745,136.8404,394.7746,145.606,399.265" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72" x="104" y="244.0698">COIN -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="120" y="261.0435">coin(it)</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="120" y="278.0171">unlock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="56" x="120" y="294.9907">reset()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="104" y="311.9644">}</text><!--MD5=[26bbedbc5621f2374cb324e59b4d4bff]
link LOCKED to COINS--><path d="M222.479,182.03 C211.257,230.875 185.82,341.587 173.684,394.407 " fill="none" id="LOCKED-to-COINS-1" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="172.552,399.333,178.4664,391.4577,173.672,394.4601,170.6697,389.6657,172.552,399.333" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="552" x="211" y="252.5698">COIN [{requiredCoins &gt;= coins+(it?:error("argument required"))}] -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="227" y="269.5435">coin(it)</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="464" x="227" y="286.5171">println("Coins=$coins, Please add ${requiredCoins-coins}")</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="211" y="303.4907">}</text><!--MD5=[d9263dcde7f2990f059c51f0359981af]
link UNLOCKED to UNLOCKED--><path d="M485.18,638.5762 C504.195,637.7129 520,644.1875 520,658 C520,670.5176 507.02,677.0086 490.433,677.4731 " fill="none" id="UNLOCKED-to-UNLOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="485.18,677.4238,494.1419,681.5085,490.1798,677.4709,494.2173,673.5088,485.18,677.4238" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72" x="526" y="646.0698">COIN -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="160" x="542" y="663.0435">returnCoin(coin(it))</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="526" y="680.0171">}</text><!--MD5=[33c2fb760a7074ec24359010ff9693f6]
link UNLOCKED to LOCKED--><path d="M485.158,655.9751 C571.658,653.0202 745.495,641.547 783,597 C835.55,534.584 826.966,290.299 772,230 C738.41,193.152 395.962,168.421 272.267,160.631 " fill="none" id="UNLOCKED-to-LOCKED" style="stroke:#383838;stroke-width:1.0;"/><polygon fill="#383838" points="267.25,160.316,275.9821,164.8712,272.2402,160.6288,276.4826,156.8868,267.25,160.316" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72" x="819" y="412.5698">PASS -&gt; {</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="835" y="429.5435">lock()</text><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="819" y="446.5171">}</text><!--MD5=[70267966a78ee317cf8634f473baeb19]
link GMN1804 to PayingTurnstileFSM--><path d="M152,33.005 C152,41.26 152,52.9008 152,65.761 C152,72.1912 152,78.9261 152,85.6952 C152,86.1182 152,86.5414 152,86.9647 C152,87.1763 152,87.388 152,87.5996 " fill="none" id="GMN1804-PayingTurnstileFSM" style="stroke:#383838;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><!--MD5=[8e625aa1128ce19dcb634af1c4ec1835]
@startuml
skinparam monochrome true
skinparam StateFontName Helvetica
skinparam defaultFontName Monospaced
skinparam defaultFontStyle Bold
skinparam state {
    FontStyle Bold
}
state coins {
COINS - -> UNLOCKED : <<automatic>> [{coins > requiredCoins}] -> {\l  returnCoin(coins-requiredCoins)\l  unlock()\l  reset()\l}
COINS - -> UNLOCKED : <<automatic>> [{coins == requiredCoins}] -> {\l  unlock()\l  reset()\l}
COINS - -> COINS : COIN -> {\l  coin(it)\l  if(coins < requiredCoins){\l  println("Please add ${requiredCoins-coins}")\l  }\l}
}
state PayingTurnstileFSM {
LOCKED - -> COINS : COIN -> {\l  coin(it)\l  unlock()\l  reset()\l}
LOCKED - -> COINS : COIN [{requiredCoins >= coins+(it?:error("argument required"))}] -> {\l  coin(it)\l  println("Coins=$coins, Please add ${requiredCoins-coins}")\l}
UNLOCKED - -> UNLOCKED : COIN -> {\l  returnCoin(coin(it))\l}
UNLOCKED - -> LOCKED : PASS -> {\l  lock()\l}
}
note top of PayingTurnstileFSM
<<invariant>> {coins >= 0}
end note
@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CAT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: ZA
--></g></svg>